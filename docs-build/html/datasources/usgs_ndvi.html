<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NDVI (USGS eMODIS) &mdash; aatoolbox  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->

        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Utilities" href="../utilities.html" />
    <link rel="prev" title="IRI Seasonal Forecast" href="iri_seasonal_forecast.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> aatoolbox
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Country Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../datasources.html">Data Sources</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="chirps.html">CHIRPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="codab.html">COD AB</a></li>
<li class="toctree-l2"><a class="reference internal" href="fewsnet.html">FEWS NET</a></li>
<li class="toctree-l2"><a class="reference internal" href="glofas.html">GloFAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="iri_seasonal_forecast.html">IRI Seasonal Forecast</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NDVI (USGS eMODIS)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#warning">Warning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#background">Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">Utilities</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">AA Toolbox API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">aatoolbox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../datasources.html">Data Sources</a></li>
      <li class="breadcrumb-item active">NDVI (USGS eMODIS)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/datasources/usgs_ndvi.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="ndvi-usgs-emodis">
<h1>NDVI (USGS eMODIS)<a class="headerlink" href="#ndvi-usgs-emodis" title="Permalink to this heading"></a></h1>
<section id="warning">
<h2>Warning<a class="headerlink" href="#warning" title="Permalink to this heading"></a></h2>
<p>The MODIS sensor has been reported by USGS to
have degraded in quality since May 2022 (dekad 13), and
updates to this data source have stopped. This module
remains for users to have access to historic data but
recent data is unavailable and care should be used
analyzing any data since dekad 13 of 2022.</p>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this heading"></a></h2>
<p>The United States Geological Survey, <a class="reference external" href="https://www.usgs.gov/">USGS</a> provides a wide
range of geo-spatial data and satellite imagery products in support of the
Famine Early Warning Systems Network, <a class="reference external" href="https://earlywarning.usgs.gov/fews">FEWS NET</a>.
These products are used to support FEWS NET drought monitoring efforts, from rainfall
data to vegetation measurements.</p>
<p>The availability of data for each source varies,
but are often available for every dekad or pentad for a number of years. The
geographic coverage is typically comprehensive of the African continent, where
the majority of FEWS NET’s work is focused, with additional areas covered on an
ad hoc basis. This module for now just provides access to the normalized
difference vegetation index (<a class="reference external" href="https://en.wikipedia.org/wiki/Normalized_difference_vegetation_index">NDVI</a>)
generated from eMODIS AQUA provided by the USGS.</p>
<p>NDVI data is generated from eMODIS AQUA and published data includes temporally smoothed NDVI, median anomaly,
difference from the previous year, and median anomaly presented as a percentile. Full methodological
details are available on the <a class="reference external" href="https://earlywarning.usgs.gov/fews/product/449#documentation">Documentation page</a>
for the specific coverage area. The data is made available for the following areas of coverage:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://earlywarning.usgs.gov/fews/product/449">north-africa</a></p></li>
<li><p><a class="reference external" href="https://earlywarning.usgs.gov/fews/product/448">east-africa</a></p></li>
<li><p><a class="reference external" href="https://earlywarning.usgs.gov/fews/product/450">southern-africa</a></p></li>
<li><p><a class="reference external" href="https://earlywarning.usgs.gov/fews/product/451">west-africa</a></p></li>
<li><p><a class="reference external" href="https://earlywarning.usgs.gov/fews/product/493">central-asia</a></p></li>
<li><p><a class="reference external" href="https://earlywarning.usgs.gov/fews/product/502">yemen</a></p></li>
<li><p><a class="reference external" href="https://earlywarning.usgs.gov/fews/product/445">central-america</a></p></li>
<li><p><a class="reference external" href="https://earlywarning.usgs.gov/fews/product/446">hispaniola</a></p></li>
</ul>
<p>Data is published at the dekadal level, and is released soon after the end of the dekad.
After a period of 3 dekads, data is updated with temporal smoothing and error correction
for cloud cover. Files for a specific dekad and region can range from 30MB up to over 100MB,
so downloading and processing can take a long time.</p>
<p>USGS publishes its data through its <a class="reference external" href="https://earlywarning.usgs.gov/fews/datadownloads/East%20Africa/eMODIS%20NDVI%20C6">web portal</a>,
which allows downloading data for a single geographical area and dekad. This data
is extracted from the <a class="reference external" href="https://edcintl.cr.usgs.gov/downloads/sciweb1/shared/fews/web/africa/east/dekadal/emodis/ndvi_c6/temporallysmoothedndvi/downloads/monthly/">back end data explorer</a>.
This module is designed to allow programmatic access to and analysis of NDVI data from the data explorer.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h2>
<p>To use this class, you first need to create a country configuration
for the country you would like to analyze. You also need to supply the area
of coverage that the country data is contained in. You can Make sure FEWS NET covers the country
of interest. You can find area of coverage for NDVI by searching for eMODIS NDVI C6 on
the  <a class="reference external" href="https://earlywarning.usgs.gov/fews/search">USGS search portal</a>.
The valid values of the area names are listed above under Background.</p>
<p>An example country config for Ethiopia is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">iso3</span><span class="p">:</span> <span class="n">eth</span>
<span class="n">usgs_ndvi</span><span class="p">:</span>
    <span class="n">region_name</span><span class="p">:</span> <span class="n">east</span><span class="o">-</span><span class="n">africa</span>
</pre></div>
</div>
<p>For a number of countries this config has been implemented already.
For others, you can create a custom country config.
Once you have created the config you can load it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aatoolbox</span> <span class="kn">import</span> <span class="n">create_country_config</span>
<span class="n">country_config</span> <span class="o">=</span> <span class="n">create_country_config</span><span class="p">(</span><span class="n">iso3</span><span class="o">=</span><span class="s2">&quot;eth&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next you need to instantiate the USGS NDVI class with the country config. For this
example, we will use the class for accessing temporally smoothed NDVI values. Since
the size of the data we will be working with is so large, we will only look at a
sample of data from a few dekads, corresponding to the dates in January:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aatoolbox</span> <span class="kn">import</span> <span class="n">UsgsNdviSmoothed</span>
<span class="n">ndvi_smooth</span> <span class="o">=</span> <span class="n">UsgsNdviSmoothed</span><span class="p">(</span>
    <span class="n">country_config</span><span class="o">=</span><span class="n">country_config</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2021-01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2021-01-31&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We will first need to download the NDVI data if you haven’t used the class before.
The code downloads all data between <cite>start_date</cite> and <cite>end_date</cite>. Be careful if not
setting start and end date during instantiation, the method will automatically
look for data between the first available data in the 19th dekad of 2002 and today.
We simply have to call the method to download available data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ndvi_smooth</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
</pre></div>
</div>
<p>Since each NDVI file is downloaded as a .tif, we can load them in individually as
rasters. We can do this for a specific date. This time we will specify the date
as a year and dekad tuple, although specify as a <cite>datetime.date</cite> or string as
above is equally appropriate.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ndvi_2021_01</span> <span class="o">=</span> <span class="n">ndvi_smooth</span><span class="o">.</span><span class="n">load_raster</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>If time series analysis is desired on the NDVI data, the user can manually do this
using loaded in data arrays. However, given the size of the individual raster files,
this module provides the <cite>process()</cite> method that calculate statistics for
a given area. For this, we need to provide a geodataframe and column to aggregate to.</p>
<p>Let’s load the country administrative boundaries for Ethiopia from our country
config, and use this to calculate basic statistics for the dekads we’ve loaded.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aatoolbox</span> <span class="kn">import</span> <span class="n">CodAB</span>

<span class="n">eth_cod</span> <span class="o">=</span> <span class="n">CodAB</span><span class="p">(</span><span class="n">country_config</span><span class="o">=</span><span class="n">country_config</span><span class="p">)</span>
<span class="c1"># assuming you&#39;ve downloaded the file already</span>
<span class="n">eth_gdf0</span> <span class="o">=</span> <span class="n">eth_cod</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">admin_level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ndvi_smooth</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
    <span class="n">gdf</span><span class="o">=</span><span class="n">eth_gdf0</span><span class="p">,</span>
    <span class="n">feature_col</span><span class="o">=</span><span class="s2">&quot;ADM0_EN&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We can then load in and use the calculated statistics using <cite>load()</cite>. Since the
processed file is saved based on the <cite>feature_col</cite> name, we have to pass
<cite>feature_col</cite> to load in the correct data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ndvi_smooth</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">feature_col</span><span class="o">=</span><span class="s2">&quot;ADM0_EN&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="iri_seasonal_forecast.html" class="btn btn-neutral float-left" title="IRI Seasonal Forecast" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../utilities.html" class="btn btn-neutral float-right" title="Utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Centre for Humanitarian Data Predictive Analytics Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
